<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Chi tiáº¿t tin tá»©c</title>
  <link id="theme-style" rel="stylesheet" href="style.css">
</head>
<script src="snow.js"></script>
<body>
  <div id="navbar"></div>

  <script type="module">
    // ğŸ”¥ Load nav.html trÆ°á»›c, rá»“i má»›i load nav.js
    fetch("nav.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("navbar").innerHTML = html;
        import('./nav.js');
      });
  </script>

  <div class="container-detail fade-in">
    <a href="news.html" class="back-btn">â¬…ï¸ Quay láº¡i tin tá»©c</a>
    <h1 id="newsTitle">Äang táº£i...</h1>
    <p class="meta" id="newsMeta"></p>
    <img id="newsImage" class="news-img" style="display:none;">
    <p id="newsBody"></p>
  </div>

  <script type="module">
    import { db } from './firebase.js';
    import { doc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

    // ğŸ”¥ Bá»c logic vÃ o hÃ m IIFE Ä‘á»ƒ cÃ³ thá»ƒ dÃ¹ng 'return'
    (async function loadNewsDetail() {
        // ğŸ” Láº¥y ID tin tá»« URL
        const params = new URLSearchParams(window.location.search);
        const newsId = params.get("id");

        const titleEl = document.getElementById("newsTitle");
        const metaEl = document.getElementById("newsMeta");
        const bodyEl = document.getElementById("newsBody");
        const imgEl = document.getElementById("newsImage");

        // ğŸ”¥ Load chi tiáº¿t tin tá»©c
        const ref = doc(db, "news", newsId);
        const snap = await getDoc(ref);
        
        if (!snap.exists()) {
            titleEl.textContent = "Tin tá»©c khÃ´ng tá»“n táº¡i ğŸ˜¢";
            return; // âœ… Return há»£p lá»‡ trong hÃ m async
        }

        const data = snap.data();
        titleEl.textContent = data.title;
        bodyEl.textContent = data.body;
        metaEl.textContent = "ğŸ—“ï¸ " + (data.createdAt?.toDate?.().toLocaleString() || "N/A");

        if (data.imageUrl) {
            imgEl.src = data.imageUrl;
            imgEl.style.display = "block";
        }
    })();
  </script>
</body>
</html>